<!DOCTYPE html>
<html>
<head>
  <title>Scala ではじめるマイクロサービス Lagom でチャットを実装してみよう！</title>
  <meta charset="utf-8">
  <link rel="shortcut icon" href="r/favicon.ico">
  <link rel="stylesheet" type="text/css" href="r/light-theme/light-theme.css" />
  <!--
  <link rel="stylesheet" type="text/css" href="r/light-theme/preview.css" />
  -->
</head>
<body>
<style>
  .remote-controller {
    position: fixed;
    left: 0;
    bottom: 0;
    z-index: 999;
    background: rgba(255, 255, 255, 0.50);
    border: 0.05rem solid rgba(255, 255, 255, 0.80);
    padding: 0 0.5rem 0 0.1rem;
    font-size: 0.6rem;
    color: rgba(0, 0, 0, 0.50);
  }
  .remote-controller input[type="checkbox"] {
    max-width:  0.5rem;
    max-height: 0.5rem;
  }
  .subscribe-control {
    cursor: pointer;
  }
  @media print {
    .remote-controller {
      display: none;
    }
  }
</style>
<label for="enable-sync" class="subscribe-control remote-controller">
  <input type="checkbox" id="enable-sync" class="subscribe-control" checked />
  <span>講演者と同期</span>
</label>
<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
<script src="r/remark-0.14.0.min.js"></script>
<script src="r/reconnecting-websocket.min.js"></script>
<script src="r/remark-remote.js"></script>
<script src="r/js.cookie.js"></script>
<script>
  var slideshow = remark.create({
    sourceUrl: 'index.md',
    highlightStyle: 'monokai',
    highlightLines: true,
    highlightSpans: true,
    navigation: {
      scroll: false
    }
  });

$(function() {

  var remote = remark.remote(slideshow, "wss://stark-dusk-4378.herokuapp.com/");
  if (window.location.search && window.location.search == "?control=true") {
    // Controllers
    $(".remote-controller").hide();
    var passcode = window.prompt("passcode?", "");
    if (passcode !== null) {
      remote.control(passcode);
    }
  } else {
    var syncConfig = {
      _key: "sync_slide",
      _opts: { expires: 7, path: '' },
      isSyncOr: function(defaultfn) {
        var isSync = Cookies.get(this._key);
        if (isSync != undefined) {
          return isSync == 'true';
        } else {
          var defaultVal = defaultfn();
          Cookies.set(this._key, defaultVal, this._opts);
          return defaultVal;
        }
      },
      sync: function() {
        Cookies.set(this._key, true, this._opts);
      },
      unsync: function() {
        Cookies.set(this._key, false, this._opts);
      }
    };
    // Follower
    var $enableSync = $("#enable-sync");
    $enableSync.isSyncEnabled = function() {
      return $enableSync.prop("checked");
    };
    $enableSync.prop("checked", syncConfig.isSyncOr($enableSync.isSyncEnabled)).change();
    var following = remote.follow();
    following.followWhen = $enableSync.isSyncEnabled;
    following.ondefiance = function() {
      if ($enableSync.isSyncEnabled()) {
        $enableSync.prop("checked", false).change();
      }
    };
    $enableSync.change(function() {
      if ($enableSync.isSyncEnabled()) {
        syncConfig.sync();
        following.sync();
      } else {
        syncConfig.unsync();
      }
    });
  }
    
  // 全てのリンクが別のタブで開くようにする (アンカーリンクは省く)
  $('a:not(a[href^=\\#])').attr({target: "_blank"});
});
</script>

</body>
</html>